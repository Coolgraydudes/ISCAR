"use client";

import { useEffect, useState } from "react";
import { useIntro } from "@/components/intro/IntroContext";

export default function SplashScreen() {
  const { setIntroReady } = useIntro();

  const LOGO_WIDTH = 110;
  const ANIMATION_DURATION = 5;
  const BASE_COLOR = "#8E8E8E";
  const FILL_COLOR = "#ffffff";

  const [animate, setAnimate] = useState(false);
  const [hidden, setHidden] = useState(false);

  useEffect(() => {
    const start = setTimeout(() => setAnimate(true), 300);
    const finish = setTimeout(() => {
      setIntroReady(true);
      setHidden(true);
    }, (ANIMATION_DURATION + 0.3) * 1000);

    return () => {
      clearTimeout(start);
      clearTimeout(finish);
    };
  }, [setIntroReady]);

  if (hidden) return null;

  return (
    <div className="fixed inset-0 z-50 flex items-center justify-center bg-black">
      <svg
        className="h-auto"
        style={{ width: LOGO_WIDTH }}
        viewBox="0 0 151 140"
        xmlns="http://www.w3.org/2000/svg"
      >
        <defs>
          <mask id="reveal-mask">
            <rect
              x="0"
              y={animate ? 0 : 140}
              width="151"
              height="140"
              fill="white"
              style={{
                transition: `y ${ANIMATION_DURATION}s ease-out`,
              }}
            />
          </mask>
        </defs>

        <path
          d="M42.1074 22.0732C42.1075 25.1189 40.393 27.1152 40.377 27.1338L22.4902 44.1465C22.4692 44.1289 15.0954 37.9635 10.7031 33.6523C6.32577 29.3557 0.0489095 22.1296 -9.64853e-07 22.0732C0.0306008 22.038 6.31933 14.7971 10.7031 10.4941C15.0955 6.18276 22.4698 0.0170455 22.4902 -5.61632e-06L40.377 17.0127C40.4017 17.0415 42.1071 19.0355 42.1074 22.0732ZM119.956 85.8301C115.967 90.2138 111.988 94.4738 108.36 98.1689C104.676 101.922 100.414 106.047 96.0332 110.18L34.0654 110.18C29.6848 106.046 25.4215 101.922 21.7373 98.1689C18.1099 94.4739 14.1313 90.2146 10.1426 85.831L29.0234 65.9853C33.2328 70.6425 37.4502 75.1865 41.2305 79.0371C42.4325 80.2615 43.7232 81.5397 45.0723 82.8662L85.0283 82.8662C86.3773 81.5398 87.6672 80.2614 88.8691 79.0371C92.6494 75.1864 96.8677 70.6426 101.077 65.9853L119.956 85.8301ZM121.954 73.0771C117.745 68.42 113.527 63.876 109.747 60.0254C108.545 58.801 107.254 57.5228 105.905 56.1963L65.9492 56.1963C64.6002 57.5227 63.3104 58.801 62.1084 60.0254C58.3281 63.8761 54.1099 68.4198 49.9004 73.0771L31.0215 53.2314C35.0102 48.8479 38.9888 44.5886 42.6162 40.8935C46.3005 37.1407 50.5637 33.016 54.9443 28.8828L116.912 28.8828C121.293 33.0158 125.555 37.1409 129.239 40.8936C132.867 44.5886 136.846 48.8478 140.835 53.2314L121.954 73.0771ZM150.977 116.988C150.977 116.988 144.668 124.254 140.273 128.567C135.884 132.876 128.516 139.037 128.486 139.062L110.6 122.049C110.575 122.021 108.868 120.027 108.868 116.988C108.868 113.953 110.573 111.96 110.6 111.929L128.486 94.915C128.486 94.915 135.875 101.093 140.273 105.41C144.651 109.707 150.929 116.933 150.977 116.988Z"
          fill={BASE_COLOR}
        />

        <path
          d="M42.1074 22.0732C42.1075 25.1189 40.393 27.1152 40.377 27.1338L22.4902 44.1465C22.4692 44.1289 15.0954 37.9635 10.7031 33.6523C6.32577 29.3557 0.0489095 22.1296 -9.64853e-07 22.0732C0.0306008 22.038 6.31933 14.7971 10.7031 10.4941C15.0955 6.18276 22.4698 0.0170455 22.4902 -5.61632e-06L40.377 17.0127C40.4017 17.0415 42.1071 19.0355 42.1074 22.0732ZM119.956 85.8301C115.967 90.2138 111.988 94.4738 108.36 98.1689C104.676 101.922 100.414 106.047 96.0332 110.18L34.0654 110.18C29.6848 106.046 25.4215 101.922 21.7373 98.1689C18.1099 94.4739 14.1313 90.2146 10.1426 85.831L29.0234 65.9853C33.2328 70.6425 37.4502 75.1865 41.2305 79.0371C42.4325 80.2615 43.7232 81.5397 45.0723 82.8662L85.0283 82.8662C86.3773 81.5398 87.6672 80.2614 88.8691 79.0371C92.6494 75.1864 96.8677 70.6426 101.077 65.9853L119.956 85.8301ZM121.954 73.0771C117.745 68.42 113.527 63.876 109.747 60.0254C108.545 58.801 107.254 57.5228 105.905 56.1963L65.9492 56.1963C64.6002 57.5227 63.3104 58.801 62.1084 60.0254C58.3281 63.8761 54.1099 68.4198 49.9004 73.0771L31.0215 53.2314C35.0102 48.8479 38.9888 44.5886 42.6162 40.8935C46.3005 37.1407 50.5637 33.016 54.9443 28.8828L116.912 28.8828C121.293 33.0158 125.555 37.1409 129.239 40.8936C132.867 44.5886 136.846 48.8478 140.835 53.2314L121.954 73.0771ZM150.977 116.988C150.977 116.988 144.668 124.254 140.273 128.567C135.884 132.876 128.516 139.037 128.486 139.062L110.6 122.049C110.575 122.021 108.868 120.027 108.868 116.988C108.868 113.953 110.573 111.96 110.6 111.929L128.486 94.915C128.486 94.915 135.875 101.093 140.273 105.41C144.651 109.707 150.929 116.933 150.977 116.988Z"
          fill={FILL_COLOR}
          mask="url(#reveal-mask)"
        />
      </svg>
    </div>
  );
}
